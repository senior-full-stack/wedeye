<div class="dashboard-add">
  <mat-progress-bar
    *ngIf="uploadingProgress" mode="determinate" [value]="uploadingProgress"></mat-progress-bar>
  <h1 mat-dialog-title>Update User</h1>
  <mat-dialog-content class="mat-typography">
    <div class="user-profile">
      <i *ngIf="!croppedImage && !f.profileUrl.value" class="fa fa-user-circle"></i>
      <img *ngIf="croppedImage" [src]="croppedImage" />
      <img *ngIf="f.profileUrl.value && !croppedImage" [src]="baseUrl + '/' + confirmUrl(f.profileUrl.value)" />
      <input type="file" (change)="fileChangeEvent($event)">
      <button *ngIf="readyToUpload" class="btn" (click)="uploadProfile()">Apply</button>
    </div>
    <div *ngIf="!uploadedProfile">
      <image-cropper
        [imageChangedEvent]="imageChangedEvent"
        [maintainAspectRatio]="true"
        [aspectRatio]="1"
        [resizeToWidth]="128"
        format="jpeg"
        (imageCropped)="imageCropped($event)"
        (imageLoaded)="imageLoaded()"
        (cropperReady)="cropperReady()"
        (loadImageFailed)="loadImageFailed()">
      </image-cropper>
    </div>
    <form #userForm="ngForm" [formGroup]="editForm" [matchValue]="['password', 'confirmPassword']">
      <input type="hidden" formControlName="profileUrl">
      <div class="form-group">
        <label for="name">Name</label>
        <input type="text" formControlName="name" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.name.errors }" placeholder="enter your name"/>
        <div *ngIf="submitted && f.name.errors" class="invalid-feedback">
          <div *ngIf="f.name.errors.required">Please enter a name</div>
        </div>
      </div>
      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" formControlName="email" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.email.errors }" placeholder="enter your email"/>
        <div *ngIf="submitted && f.email.errors" class="invalid-feedback">
            <div *ngIf="f.email.invalid && f.email.errors.required">Please enter an email</div>
            <div *ngIf="f.email.invalid && f.email.errors.email && (f.email.dirty || f.email.touched)">Please enter a valid email</div>
            <div *ngIf="f.email.invalid && f.email.errors.emailTaken">This email has been taken, please use another one.</div>
        </div>
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" formControlName="password" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.password.errors }" placeholder="enter your password" />
        <div *ngIf="submitted && f.password.errors" class="invalid-feedback">
          <div *ngIf="f.password.errors.required">Please enter a password</div>
        </div>
      </div>
      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input type="password" formControlName="confirmPassword" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.confirmPassword.errors }" placeholder="enter your confirm password" />
        <div *ngIf="submitted && f.confirmPassword.errors" class="invalid-feedback">
          <div *ngIf="f.confirmPassword.errors.required">Confirm Password is required</div>
          <div *ngIf="f.confirmPassword.errors.matchValueError">Confirm Password & Password must be same.</div>
        </div>
      </div>
      <div *ngIf="data.type!=='admin'" class="form-group">
        <label for="type">Type</label>
        <!-- Material inline 1 -->
        <div>
          <div class="form-check form-check-inline">
            <input type="radio" class="form-check-input" value="vendor" formControlName="type">
            <label class="form-check-label" for="materialInline1">Vendor</label>
          </div>
  
          <!-- Material inline 2 -->
          <div class="form-check form-check-inline">
            <input type="radio" class="form-check-input" value="customer" formControlName="type">
            <label class="form-check-label" for="materialInline2">Customer</label>
          </div>
        </div>
      </div>
      <div *ngIf="userForm.value.type=='customer'" class="form-group">
        <label for="relation">Relation</label>
        <input type="text" formControlName="relation" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.relation.errors }" placeholder="enter bride or groom or other"/>
      </div>
      <div *ngIf="userForm.value.type=='customer'" class="form-group">
        <label>Wedding Date</label>
        <input type="date" formControlName="weddingDate" min="1000-01-01"
                max="3000-12-31" class="form-control">
      </div>
      <div class="form-group">
        <label for="phone">Phone</label>
        <input type="text" formControlName="phone" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.phone.errors }" placeholder="enter your phone" />
      </div>
      <div class="form-group">
        <label for="address">Address</label>
        <textarea formControlName="address" class="form-control"
            [ngClass]="{ 'is-invalid': submitted && f.address.errors }" placeholder="enter your address"></textarea>
      </div>
      <div *ngIf="data.type!=='admin'" class="form-group">
        <label for="status">Status</label>
        <select formControlName="status" class="form-control">
          <option value="1">Active</option>
          <option value="2">Inactive</option>
          <option value="3">Suspended</option>
          <option value="4">On Hold</option>
          <option value="5">Payment Done</option>
          <option value="6">Featured Account</option>
        </select>
      </div>
    </form>
  </mat-dialog-content>
  <mat-dialog-actions align="end">
    <button class="btn" mat-dialog-close>Cancel</button>
    <button class="btn" (click)="updateUser(userForm)">Save</button>
  </mat-dialog-actions>  
</div>